{% load static %}
{% load tags %}
{% load humanize %}

<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Thai&display=swap" rel="stylesheet">

    <style>
@page {
  size: 7in 9.25in;
  margin: 27mm 16mm 27mm 16mm;
}
    .thai-font {
      font-family: "Noto Serif Thai", serif;
      font-optical-sizing: auto;
      font-weight: 400;
      font-style: normal;
      font-variation-settings:
        "wdth" 100;
    }

    .table-bg {
      background: #343a40;
      color: white;
    }

    td {
      font-size: 0.8em;
    }

    </style>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>TCC - {% block title %}ใบส่งคืน ที่ {{ context.bill.pk }}/{{ context.bill }}{% endblock %}</title>
    <meta content="" name="description">
    <meta content="" name="keywords">


    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Krub:wght@300&display=swap" rel="stylesheet"> -->
    <!-- add fontawsome icon -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- add bootsrap5 cdn -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://unpkg.com/pagedjs/dist/paged.polyfill.js"></script>


  </head>

  <body>
    <main id="main" class="thai-font">
      {% block content %}

      <table class="table table-bordered" style="text-align: center; width: 100%; vertical-align: middle; border: 1px solid black;">
        
        <tr>
          <td colspan="4" style="width: 75%;"><b>ใบส่งคืน</b></td>
          <td colspan="4" class="page-number" id="pageNumberId">แผ่นที่ </td>
        </tr>

        <tr>
          <td rowspan="2" style="width: 10%;">ถึง</td>
          <td rowspan="2" style="width: 20%;">หน่วยรับคืน</td>
          <td rowspan="2" style="width: 20%;">{{ context.bill.stock }}</td>

          <td rowspan="2" colspan="2">ที่ใบส่งคืน</td>

          <td colspan="2">สายงานที่ควบคุม</td>
          <td >{{ context.bill_detail.item_control|default:'-' }}</td>

        </tr>

        <tr>
          <td colspan="2">ประเภทสิ่งอุปกรณ์</td>
          <td >{{ context.bill_detail.item_type|default:'-' }}</td>
        </tr>
        
        <tr>
          <td rowspan="2" style="width: 10%;">จาก</td>
          <td rowspan="2" style="width: 20%;">หน่วยส่งคืน</td>
          <td rowspan="2" style="width: 20%;">{{ context.bill.user.profile.department }}</td>

          <td rowspan="2" colspan="2">ที่ใบส่งคืน</td>

          <td colspan="2">ประเภทเงิน</td>
          <td >{{ context.bill_detail.money_type|default:'-' }}</td>

        </tr>

        <tr>
          <td colspan="2">เลขที่งาน</td>
          <td >{{ context.bill_detail.job_no|default:'-' }}</td>
        </tr>

        <tr>
          <td rowspan="2">ลำดับ</td>
          <td rowspan="2">หมายเลขสิ่งอุปกรณ์</td>
          <td rowspan="2">รายการ</td>
          <td rowspan="2">หน่วยนับ</td>
          <td rowspan="2">จำนวน</td>
          <td colspan="2">ราคา</td>
          <td rowspan="2">รับจริง</td>
        </tr>

        <tr>
          <td>หน่วยละ</td>
          <td>รวม</td>
        </tr>

        {% for item in context.items %}
        
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>
            {{ item.item.serial|default:"-" }}
          </td>
          <td>{{ item.item.category }}</td>
          <td>{{ item.item.count_text|default:"หน่วย" }}</td>
          <td>{{ item.item.quantity }}</td>
          <td>{{ item.item.price|intcomma|default:"-" }}</td>
          <td>{{ item.total_price|intcomma|default:"-" }}</td>
          <td>{{ item.item.quantity }}</td>
        </tr>

        {% if forloop.last %}
        <tr>
          <td colspan="8">/////////////////////// หมดรายการ ///////////////////////</td>
        </tr>
        {% endif %}

        {% endfor %}
      
      </table>


      <!-- <div id="footer_content"><pdf:pagenumber>/<pdf:pagecount></div> -->
      <!-- <div>Page <span class="page-number"><pdf:pagenumber> of <pdf:pagecount></span></div> -->

      {% endblock %}

    </main><!-- End #main -->


  </body>

</html>
