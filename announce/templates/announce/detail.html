{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load tags %}
{% load tz %}

  {% block title %}Announce{% endblock title %}

  <style>
  #canvas_container {
    width: 800px;
    height: 450px;
    overflow: auto;
  }

  #canvas_container {
    background: #333;
    text-align: center;
    border: solid 3px;
  }
  </style>
  {% block content %}
  <div class="pagetitle">
    <h1>{{ object.title }}</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'announce:list' %}">Announce List</a></li>
        <li class="breadcrumb-item active">{{ object.title }}</li>
      </ol>
    </nav>
  </div><!-- End Page Title -->


  <section class="section">
    <div class="row">

      <div class="col-xl-12">

        <div class="card">
          <div class="card-body pt-3">
            <ul class="nav nav-tabs nav-tabs-bordered">
              <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#detail">
                  รายละเอียด
                </button>
              </li>

              {% if images %}
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#images">
                  รูปภาพประกอบประชาสัมพันธ์/สั่งการ
                </button>
              </li>
              {% endif %}

              {% if files_list %}
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#files">
                  ไฟล์ประกอบประชาสัมพันธ์/สั่งการ
                </button>
              </li>
              {% endif %}
            </ul>

            <div class="tab-content pt-2">
              <div id="detail" class="tab-pane fade show active">
                {% include "announce/components/detail.html" %}
              </div>

              <div id="images" class="tab-pane fade pt-3">
                <h6 class="card-title"> รูปภาพประกอบประชาสัมพันธ์ | <span> {{ object.title }}</span></h6>
                <div id="gallery">
                  {% for item in images %}
                  {% comment %} <a class="col s12 m3" href="{{ item.images.url }}" target="_blank">
                  <img height="150" width="150" src="{{ item.images.url }}" alt="">
                  </a> {% endcomment %}
                  <a class="col s12 m3" href="javascript:pswpInit({{forloop.counter0}})">
                    <img height="250" width="250" src="{{ item.images.url }}" alt="">
                  </a>
                  {% endfor %}
                </div>
              </div>

              <div id="files" class="tab-pane fade pt-3">
                <h6 class="card-title"> ไฟล์ประกอบประชาสัมพันธ์ | <span> {{ object.title }}</span></h6>
                {% for f in files_list %}

                <iframe src="{{ f.files.url }}" frameborder="0" style="width: 100%; height: 800px;"></iframe>
                <br>
                {% comment %}<a href="{{ f.files.url }}" target="_blank">เอกสารที่เกี่ยวข้อง--{{ f.files.name }}</a>{% endcomment %}

                {% comment %}<p>Download - <a href="{{ f.files.url }}">เอกสารนี้</a></p>{% endcomment %}
                {% with f.files.name|split:"/" as file %}
                <p>Download - <a href="{{ f.files.url }}">{{ file|last }}</a></p>
                {% comment %}{{ file|last }}{% endcomment %}
                {% endwith %}

                {% endfor %}

              </div>

            </div><!-- End Tab -->

          </div>
        </div>

        <!-- Announce Detail -->

      </div>
    </div>

    <!-- reader sector -->
    <div class="card">
      {% include "announce/components/readers.html" %}
    </div><!-- end reader -->


    <!-- comment sector -->
    {% include "announce/components/comments.html" %}

  </section>
  {% include 'components/photoswipe.html' %}
  <script>
  $(document).ready(() => {
    $("#dataTable").DataTable({
      "fnDrawCallback" : function(oSettings) {
        if (oSettings._iDisplayLength > oSettings.fnRecordsDisplay()) {
          $(oSettings.nTableWrapper).find('.dataTables_paginate').hide();
        } else {
          $(oSettings.nTableWrapper).find('.dataTables_paginate').show();
        }
      },
      "lengthMenu": [ [10, 25, 50, -1], [10, 25, 50, "All"] ],
    });
  });
  </script>
  {% endblock content %}

